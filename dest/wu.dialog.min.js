/*!
https://github.com/wusfen/wu.dialog.js/
对话框
2014.11.7
2016.4.8

var dialog = wu.dialog({
	css: {}, // 自定义 css
	overlay: true, // 遮罩层
	isOverlayClickClose: true, // 遮罩层点击关闭
	el: null, // 对话框元素 #id
	url: null, // 动态内容 'dialog.html'
	iframe: true, // url 是否用iframe
	scrolling: 'no', // iframe 是否滚动
	show: false // 是否立即显示
});
dialog.init({...})
dialog.open()
dialog.resize()
dialog.close()

var d2 = wu.dialog.new({...});

<a wu-dialog="{}" href="dialogUrl">dialog</a>
*/
+function(wu){var setting={css:{},overlay:!0,isOverlayClickClose:!0,el:null,url:null,iframe:!0,scrolling:"no",show:!1},Dialog=function(i){i=i||{};var o,t,e,n,l;o=$('<div class="wu-dialog-overlay">').css({position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"#111",opacity:.25,zIndex:9999}),$("body").append(o.hide());var s;o.click(function(){s&&h()}),t=$('<div class="wu-dialog-wp">'),$("body").append(t.hide());var a=function(i){i=i||{};for(var o in setting)void 0===i[o]&&(i[o]=setting[o]);if(s=i.isOverlayClickClose,t.css("style","").css({position:"fixed",zIndex:99999999,maxWidth:"100%",maxHeight:"100%"}).css(i.css),i.url)if(i.iframe){var n=$('<iframe style="display:block;max-width:100%" src="'+i.url+'" scrolling="'+i.scrolling+'" frameborder="0" allowtransparency="true"></iframe>');n[0].onload=function(){try{var i=this.contentDocument.getElementsByTagName("html")[0];this.style.height=i.scrollHeight+1.5+"px",this.style.width=i.scrollWidth+1.5+"px"}catch(o){}c(),this.setAttribute("scrolling","yes")},t.html(n),r()}else t.load(i.url,function(){i.show&&(r(),setTimeout(function(){c()},1e3))});else e=$(i.el),i.show&&r()},r=function(){return o.fadeIn(),t.show(),-1==location.hash.lastIndexOf("#dialog")&&(location.hash+="#dialog"),i.el&&(n||(n=$('<i style="display:none"></i>'),e.after(n)),l=e.css("display"),"none"==l&&e.show(),t.append(e)),c(),this},c=function(){return t.css({left:(document.body.clientWidth-t.outerWidth())/2,top:(window.innerHeight-t.outerHeight())/5*2}),this},h=function(){return-1!=location.hash.lastIndexOf("#dialog")&&history.go(-1),n&&n.before(e.css("display",l)),o.fadeOut(),t.hide(),this};return a(i),$(window).resize(function(){c()}),$(window).on("hashchange",function(){-1==location.hash.lastIndexOf("#dialog")&&h()}),{init:a,open:r,resize:c,close:h}},singleDialog;wu.dialog=function(i){return singleDialog?(singleDialog.init(i),singleDialog):singleDialog=Dialog(i)},wu.dialog["new"]=function(i){return Dialog(i)},$("body").on("click","[wu-dialog]",function(e){e.preventDefault();var options=eval("("+($(this).attr("wu-dialog")||"{}")+")"),href=$(this).attr("href");href&&(options.url=href),options.show=!0,wu.dialog(options)})}(this.wu||(wu={}));